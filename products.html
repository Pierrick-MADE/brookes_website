<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- author: Pierrick MADE -->
        <title>Fired Bowl World Ceramics - Products</title>

        <!-- Stylesheets -->
        <link type="text/css" rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        <!-- Meta data -->

        <!-- Tags -->

        <!-- Responsive tag -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    </head>

    <body onload="initData()">
        <!-- Navigation -->
        <nav>
            <a id="navbar-logo" href="index.html">
                <img src="img/logo_fired_bowl.png" alt="logo">
            </a>
            <div class="navbar-items">
                <button class="navbar-toggle" onclick="toggle_menu()"><i class="fas fa-bars"></i></button>
                <a class="navbar-item item1" href="index.html">Home</a>
                <a class="navbar-item item2 active" href="products.html">Products</a>
                <a class="navbar-item item3" href="about.html">About</a>
                <a class="navbar-item item4" href="contact.html">Contact</a>
                <a class="navbar-item item5" href="cart.html"><i class="fas fa-shopping-cart"></i></a>
                <hr/>
            </div>
        </nav>

        <!-- Page Content -->
        <main>
            <div class="padding-20">
                <div class="">
                    <a href="index.html">Home</a> / Products
                </div>
            </div>
            <div class="row">
                <div class="col c3 filters">
                    <div class="padding-20">
                        <div class="filter category">
                            <div class="text-title">Filter</div>
                            <a onclick="filter('all')">
                                Show All
                            </a>
                            <a onclick="filter('Plate')">
                                Plate
                            </a>
                            <a onclick="filter('Bowl')">
                                Bowl
                            </a>
                            <a onclick="filter('Platter')">
                                Platter
                            </a>
                            <a onclick="filter('Tagine')">
                                Tagine
                            </a>
                            <a onclick="filter('Tea-Set')">
                                Tea Set
                            </a>
                            <a onclick="filter('Jug')">
                                Jug
                            </a>
                            <a onclick="filter('Other')">
                                Other
                            </a>
                        </div>
                        <div class="filter sort">
                            <div class="text-title">Sort by</div>
                            <a onclick="sort('featured')">
                                Featured
                            </a>
                            <a onclick="sort('az')">
                                Alphabetic order
                            </a>
                            <a onclick="sort('incPrice')">
                                Price: Low to High
                            </a>
                            <a onclick="sort('decPrice')">
                                Price: High to Low
                            </a>
                            <a onclick="sort('type')">
                                Type
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col c9">
                    <div id="products" class="row">
                        XML and javascript does not seem to work ....
                        <div id="1" class="Platter c12 relative box-shadow">
                            <div class="col c6">
                                <div class="padding-20">
                                    <div class="relative image-btn">
                                        <a class="product-img" onclick="seeProduct('1')">
                                            <img class="box-shadow" src="img/1.jpg" width="100%" alt="Bowls">
                                            <div class="absolute onImage price text-title">
                                                34
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col c6 hide product-details">
                                <div class="absolute product-close-btn">
                                    <a onclick="closeProduct('1')"><i class="fas fa-times"></i></a>
                                </div>
                                <div class="padding-20">
                                    <div class="text-title product-title">
                                        TestA
                                    </div>
                                    <button class="add-to-cart" onclick="">ADD to cart</button>
                                    Large hand painted Moroccan terracotta rim bowl in a traditional design<br>
                                </div>
                            </div>
                            <div class="col c12 hide product-description">
                                <div style="padding: 0 20px 20px 20px">

                                    Hand made in Fez in Morocco, these lovely large platters are as useful as they are beautiful.<br><br>
                                    The ideal size for a the centre of the table, great for serving a fruit, large salads or rice. Each one is hand painted and unique and bringing a true taste of Moroccan culture to your home.<br><br>
                                    They make the perfect gift
                                </div>
                            </div>
                        </div>

                        <div id="2" class="Bowl c12 relative box-shadow">
                            <div class="col c6">
                                <div class="padding-20">
                                    <div class="relative image-btn">
                                        <a class="product-img" onclick="seeProduct('2')">
                                            <img class="box-shadow" src="img/2.jpg" width="100%" alt="Bowls">
                                            <div class="absolute onImage price text-title">
                                                32
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col c6 hide product-details">
                                <div class="absolute product-close-btn">
                                    <a onclick="closeProduct('2')"><i class="fas fa-times"></i></a>
                                </div>
                                <div class="padding-20">
                                    <div class="text-title product-title">
                                        testc
                                    </div>
                                    <button class="add-to-cart" onclick="">ADD to cart</button>
                                    Large hand painted Moroccan terracotta rim bowl in a traditional design<br>
                                </div>
                            </div>
                            <div class="col c12 hide product-description">
                                <div style="padding: 0 20px 20px 20px">

                                    Hand made in Fez in Morocco, these lovely large platters are as useful as they are beautiful.<br><br>
                                    The ideal size for a the centre of the table, great for serving a fruit, large salads or rice. Each one is hand painted and unique and bringing a true taste of Moroccan culture to your home.<br><br>
                                    They make the perfect gift
                                </div>
                            </div>
                        </div>

                        <div id="3" class="Plate c12 relative box-shadow">
                            <div class="col c6">
                                <div class="padding-20">
                                    <div class="relative image-btn">
                                        <a class="product-img" onclick="seeProduct('3')">
                                            <img class="box-shadow" src="img/3.jpg" width="100%" alt="Bowls">
                                            <div class="absolute onImage price text-title">
                                                94
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col c6 hide product-details">
                                <div class="absolute product-close-btn">
                                    <a onclick="closeProduct('3')"><i class="fas fa-times"></i></a>
                                </div>
                                <div class="padding-20">
                                    <div class="text-title product-title">
                                        testb
                                    </div>
                                    <button class="add-to-cart" onclick="">ADD to cart</button>
                                    Large hand painted Moroccan terracotta rim bowl in a traditional design<br>
                                </div>
                            </div>
                            <div class="col c12 hide product-description">
                                <div style="padding: 0 20px 20px 20px">

                                    Hand made in Fez in Morocco, these lovely large platters are as useful as they are beautiful.<br><br>
                                    The ideal size for a the centre of the table, great for serving a fruit, large salads or rice. Each one is hand painted and unique and bringing a true taste of Moroccan culture to your home.<br><br>
                                    They make the perfect gift
                                </div>
                            </div>
                        </div>

                        <div id="4" class="Platter c12 relative box-shadow">
                            <div class="col c6">
                                <div class="padding-20">
                                    <div class="relative image-btn">
                                        <a class="product-img" onclick="seeProduct('4')">
                                            <img class="box-shadow" src="img/4.jpg" width="100%" alt="Bowls">
                                            <div class="absolute onImage price text-title">
                                                68
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col c6 hide product-details">
                                <div class="absolute product-close-btn">
                                    <a onclick="closeProduct('4')"><i class="fas fa-times"></i></a>
                                </div>
                                <div class="padding-20">
                                    <div class="text-title product-title">
                                        testa
                                    </div>
                                    <button class="add-to-cart" onclick="">ADD to cart</button>
                                    Large hand painted Moroccan terracotta rim bowl in a traditional design<br>
                                </div>
                            </div>
                            <div class="col c12 hide product-description">
                                <div style="padding: 0 20px 20px 20px">

                                    Hand made in Fez in Morocco, these lovely large platters are as useful as they are beautiful.<br><br>
                                    The ideal size for a the centre of the table, great for serving a fruit, large salads or rice. Each one is hand painted and unique and bringing a true taste of Moroccan culture to your home.<br><br>
                                    They make the perfect gift
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </main>


        <!-- POPUP -->
        <div class="popup hide">
            <div class="popup-content relative">
                <img class="absolute popup-img" src="img/empty.png" width="100%">
                <a class="absolute popup-close-btn"><i class="fas fa-search-minus"></i></a>
            </div>
        </div>


        <!-- Footer -->
        <footer class="row centered">
            <div class="col c4">
                <a href="index.html">Home</a><br>
                <a href="products.html">Products</a><br>
                <a href="about.html">About</a><br>
                <a href="contact.html">Contact</a><br>
                <a href="cart.html">Cart</a>
            </div>
            <div class="col c4">
                <a class="icon" href="#"><i class="fab fa-facebook-square"></i></a>
                <a class="icon" href="#"><i class="fab fa-twitter-square"></i></a>
                <a class="icon" href="#"><i class="fab fa-instagram"></i></a>
                <a class="icon" href="#"><i class="far fa-envelope"></i></a><br>
                +33 6 00 11 22 33<br>
                contact@firedBowl.com<br>
                68 Hollow road, London, UK<br>
                Monday-Saturday : 8am - 5pm

            </div>
            <div class="col c4">
                Newsletter
                <form action="">
                    <input type="text" name="Mail" placeholder="Email Adress">
                    <br>
                    <input type="submit" value="Subscribe">
                </form> 
            </div>
        </footer>

        <!-- Scripts -->
        <script>
            function toggle_menu(){
                var items = document.getElementsByClassName("navbar-item");
                var icon_toggle = document.getElementsByClassName("navbar-toggle")[0];
                document.getElementsByTagName("main")[0].classList.toggle("toggled");
                for (i = 0; i < items.length; i++){
                    items[i].classList.toggle("toggled");
                }
                if (icon_toggle.classList.toggle("toggled")){
                    icon_toggle.innerHTML = "<i class=\"fas fa-angle-up\"></i>";
                }else{
                    icon_toggle.innerHTML = "<i class=\"fas fa-bars\"></i>"
                }
            }
            function seeProduct(product_id){

                closeAllProducts();

                var product = document.getElementById(product_id);
                var details = product.getElementsByClassName("product-details")[0];
                var description = product.getElementsByClassName("product-description")[0];
                var img = product.getElementsByClassName("product-img")[0];

                product.classList.add("product-toggled");
                details.classList.remove("hide");
                description.classList.remove("hide");
                img.setAttribute("onclick", "seePicture('" + img.getElementsByTagName("img")[0].getAttribute("src") + "')" );
                img.style.cursor = "zoom-in";

                /* Scroll to the item*/
                product.scrollIntoView({behavior: "smooth", block: "end", inline: "nearest"});
            }
            function closeProduct(product_id){
                var product = document.getElementById(product_id);
                var details = product.getElementsByClassName("product-details")[0];
                var description = product.getElementsByClassName("product-description")[0];
                var img = product.getElementsByClassName("product-img")[0];

                product.classList.remove("product-toggled");
                details.classList.add("hide");
                description.classList.add("hide");
                img.setAttribute("onclick", "seeProduct('" + img.getElementsByTagName("img")[0].getAttribute("src") + "')" );
                console.log("img:src : ", img.getElementsByTagName("img")[0].getAttribute("src"));
                img.style.cursor = "pointer";
            }
            function closeAllProducts(){
                var already_toggled_products = document.getElementsByClassName("product-toggled");
                for(var i=0; i < already_toggled_products.length; i++){
                    closeProduct(already_toggled_products[i].getAttribute("id"));
                }
            }
            function seePicture(img_path){
                var popup = document.getElementsByClassName("popup")[0];
                var img = popup.getElementsByTagName("img")[0];
                var body = document.getElementsByTagName("body")[0];
                img.setAttribute("src", img_path);
                popup.setAttribute("onclick", "seePicture('" + img_path + "')" );
                if (popup.classList.toggle("hide")){
                    body.style.overflow = "auto";
                }else{
                    body.style.overflow = "hidden";
                }
            }
            function filter(type){
                closeAllProducts();

                var products = document.getElementById("products").children;

                /*for each product : check if class contains type or not*/
                for (var i=0; i < products.length; i++){
                    console.log("product", products[i]);
                    if (products[i].classList.contains(type) || type === "all"){
                        products[i].classList.remove("hide");
                    }else{
                        products[i].classList.add("hide");
                    }
                }

                /* make the filter button used active (e.g. bold) */
                var buttons = document.getElementsByClassName("filter category")[0].children;
                for (var i = 1; i < buttons.length; i++){
                    if (buttons[i].getAttribute("onclick") === "filter(\'"+type+"\')"){
                        buttons[i].classList.add("active");
                    }else{
                        buttons[i].classList.remove("active");
                    }
                }
            }
            function sort(sortType){
                closeAllProducts();

                var products = document.getElementById("products").children;
                var sorted = false;
                switch(sortType){
                    case "featured":
                        for (x=0; x<products.length && !sorted; x++){
                            sorted = true;
                            for (i=0; i<(products.length-x-1); i++){
                                var id1 = products[i].getAttribute("id");
                                var id2 = products[i+1].getAttribute("id");
                                if ( id1 > id2 ){
                                    products[i].parentNode.insertBefore(products[i+1],
                                                                        products[i]);
                                    sorted = false;
                                }
                            }
                        }
                        break;
                    case "az":
                        for (x=0; x<products.length && !sorted; x++){
                            sorted = true;
                            for (i=0; i<(products.length-x-1); i++){
                                var name1 = products[i].getElementsByClassName("product-title")[0].innerHTML.toLowerCase();
                                var name2 = products[i+1].getElementsByClassName("product-title")[0].innerHTML.toLowerCase();
                                if ( name1 > name2 ){
                                    products[i].parentNode.insertBefore(products[i+1],
                                                                        products[i]);
                                    sorted = false;
                                }
                            }
                        }
                        break;
                    case "incPrice":
                        for (x=0; x<products.length && !sorted; x++){
                            sorted = true;
                            for (i=0; i<(products.length-x-1); i++){
                                var price1 =
                                    parseFloat(products[i].getElementsByClassName("price")[0].innerHTML);
                                var price2 =
                                    parseFloat(products[i+1].getElementsByClassName("price")[0].innerHTML);
                                if ( price1 > price2 ){
                                    products[i].parentNode.insertBefore(products[i+1],
                                                                        products[i]);
                                    sorted = false;
                                }
                            }
                        }
                        break;
                    case "decPrice":
                        for (x=0; x<products.length && !sorted; x++){
                            sorted = true;
                            for (i=0; i<(products.length-x-1); i++){
                                var price1 =
                                    parseFloat(products[i].getElementsByClassName("price")[0].innerHTML);
                                var price2 =
                                    parseFloat(products[i+1].getElementsByClassName("price")[0].innerHTML);
                                if ( price1 < price2 ){
                                    products[i].parentNode.insertBefore(products[i+1],
                                                                        products[i]);
                                    sorted = false;
                                }
                            }
                        }
                        break;
                    case "type":
                        for (x=0; x<products.length && !sorted; x++){
                            sorted = true;
                            for (i=0; i<(products.length-x-1); i++){
                                var type1 =
                                    products[i].getElementsByClassName("price")[0].innerHTML;
                                var type2 =
                                    products[i+1].getElementsByClassName("price")[0].innerHTML;
                                if ( type1 > type2 ){
                                    products[i].parentNode.insertBefore(products[i+1],
                                                                        products[i]);
                                    sorted = false;
                                }
                            }
                        }
                        break;
                    default:
                        break;
                }
                /* make the filter button used active (e.g. bold) */
                var buttons = document.getElementsByClassName("filter sort")[0].children;
                for (var i = 1; i < buttons.length; i++){
                    if (buttons[i].getAttribute("onclick") === "sort(\'"+sortType+"\')"){
                        buttons[i].classList.add("active");
                    }else{
                        buttons[i].classList.remove("active");
                    }
                }
            }
            function initData(){
                /*xml initialisation*/ /*help from w3schools*/
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        initProducts(xhttp.responseXML);
                    }
                };
                xhttp.open("GET", "data/products.xml", true);
                xhttp.send(); 
            }
            function initProducts(xmlDoc){
                /* create a child for each product of the xml page*/
                /* and append this child to products */
                var productsTXT = "";
                var products = xmlDoc.getElementsByTagName("product");
                for (var i=0; i < products.length; i++){
                    productsTXT += "<div id=\"";
                    productsTXT += products[i].getAttribute("id");
                    productsTXT += "\" class=\"";
                    productsTXT += products[i].getAttribute("category");
                    productsTXT += " c12 relative box-shadow\"><div class=\"col c6\"><div class=\"padding-20\"><div class=\"relative image-btn\"><a class=\"product-img\" onclick=\"seeProduct('";
                    productsTXT += products[i].getAttribute("id");
                    productsTXT += "')\"><img class=\"box-shadow\" src=\"img/";
                    productsTXT += products[i].getElementsByTagName("img")[0].childNodes[0].nodeValue;
                    productsTXT += ".jpg\" width=\"100%\" alt=\"";
                    productsTXT += products[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
                    productsTXT += "\"><div class=\"absolute onImage price text-title\">";
                    productsTXT += products[i].getElementsByTagName("price")[0].childNodes[0].nodeValue;
                    productsTXT += "</div></a></div></div></div><div class=\"col c6 hide product-details\"><div class=\"absolute product-close-btn\"><a onclick=\"closeProduct('";
                    productsTXT += products[i].getAttribute("id");
                    productsTXT += "')\"><i class=\"fas fa-times\"></i></a></div><div class=\"padding-20\"><div class=\"text-title product-title\">";
                    productsTXT += products[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
                    productsTXT += "</div><button class=\"add-to-cart\" onclick=\"\">ADD to cart</button>";
                    productsTXT += products[i].getElementsByTagName("short_description")[0].childNodes[0].nodeValue;
                    productsTXT += "</div></div><div class=\"col c12 hide product-description\"><div style=\"padding: 0 20px 20px 20px\">";
                    productsTXT += products[i].getElementsByTagName("full_description")[0].childNodes[0].nodeValue;
                    productsTXT += "</div></div></div>";
                }
                document.getElementById("products").innerHTML = productsTXT;
                homePageFilter();
            }
            function homePageFilter(){
                /*filters from home page*/
                var homeFilter = sessionStorage.getItem("homeFilter")
                if (homeFilter){
                    filter(homeFilter);
                }
                sessionStorage.setItem("homeFilter","");

                var products = document.getElementById("products");

            }
        </script>
    </body>
</html>